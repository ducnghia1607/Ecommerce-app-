"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[901],{901:(E,g,r)=>{r.r(g),r.d(g,{ShopModule:()=>G});var c=r(6895),x=r(4466),u=r(9838),P=r(5698),t=r(1571),m=r(529);class _{constructor(){this.pageSize=6,this.pageIndex=1,this.brandId=0,this.typeId=0,this.sort="name",this.search=""}}var y=r(2340),d=r(9646),h=r(4004);let f=(()=>{class i{constructor(e){this.http=e,this.baseUrl=y.N.apiUrl,this.products=[],this.brands=[],this.types=[],this.productParams=new _,this.productCache=new Map}getProducts(e=!0){if(e||(this.productCache=new Map),this.productCache.size>0&&e&&this.productCache.has(Object.values(this.productParams).join("-"))&&(this.pagination=this.productCache.get(Object.values(this.productParams).join("-")),this.pagination))return(0,d.of)(this.pagination);let n=new m.LE;return this.productParams.brandId>0&&(n=n.append("brandId",this.productParams.brandId)),this.productParams.typeId>0&&(n=n.append("typeId",this.productParams.typeId)),this.productParams.sort&&(n=n.append("sort",this.productParams.sort)),n=n.append("pageIndex",this.productParams.pageIndex),n=n.append("pageSize",this.productParams.pageSize),this.productParams.search&&(n=n.append("search",this.productParams.search)),this.http.get(this.baseUrl+"products",{params:n}).pipe((0,h.U)(o=>(this.productCache.set(Object.values(this.productParams).join("-"),o),this.pagination=o,console.log(this.productCache),o)))}getProductParams(){return this.productParams}setProductParams(e){this.productParams=e}getProduct(e){const n=[...this.productCache.values()].reduce((o,s)=>({...o,...s.data.find(p=>p.id===e)}),{});return 0!==Object.keys.length?(0,d.of)(n):this.http.get(this.baseUrl+"products/"+e)}getBrands(){return this.brands.length>0?(0,d.of)(this.brands):this.http.get(this.baseUrl+"products/brands").pipe((0,h.U)(e=>(this.brands=e,e)))}getTypes(){return this.types.length>0?(0,d.of)(this.types):this.http.get(this.baseUrl+"products/types").pipe((0,h.U)(e=>(this.types=e,e)))}static#t=this.\u0275fac=function(n){return new(n||i)(t.LFG(m.eN))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var C=r(8909),v=r(5866);function b(i,a){if(1&i&&(t.TgZ(0,"h5",12),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" You have ",e.quantityInBasket," of this product in your basket ")}}function T(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",1)(1,"div",2),t._UZ(2,"img",3),t.qZA(),t.TgZ(3,"div",4)(4,"h3",5),t._uU(5),t.qZA(),t.TgZ(6,"h5",5),t._uU(7),t.ALo(8,"currency"),t.qZA(),t.YNc(9,b,2,1,"h5",6),t.TgZ(10,"div",7)(11,"i",8),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.decrementQuantity())}),t.qZA(),t.TgZ(12,"span",9),t._uU(13),t.qZA(),t.TgZ(14,"i",10),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.incrementQuantity())}),t.qZA(),t.TgZ(15,"button",11),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.updateBasket(o.product))}),t._uU(16),t.qZA()(),t.TgZ(17,"h5",5),t._uU(18,"Description"),t.qZA(),t.TgZ(19,"p"),t._uU(20),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.s9C("src",e.product.pictureUrl,t.LSH),t.xp6(3),t.Oqu(e.product.name),t.xp6(2),t.Oqu(t.lcZ(8,8,e.product.price)),t.xp6(2),t.Q6J("ngIf",0!=e.quantityInBasket),t.xp6(4),t.Oqu(e.quantity),t.xp6(2),t.Q6J("disabled",e.quantity==e.quantityInBasket),t.xp6(1),t.hij(" ",e.buttonText," "),t.xp6(4),t.Oqu(e.product.description)}}let I=(()=>{class i{constructor(e,n,o,s){this.shopService=e,this.activetedRoute=n,this.bsService=o,this.basketService=s,this.quantity=0,this.quantityInBasket=0,this.bsService.set("@productDetails"," "),this.getProduct()}ngOnInit(){}getProduct(){const e=this.activetedRoute.snapshot.paramMap.get("id");e&&this.shopService.getProduct(+e).subscribe({next:n=>{this.product=n,this.bsService.set("@productDetails",this.product.name),this.basketService.basketSource$.pipe((0,P.q)(1)).subscribe({next:o=>{const s=o?.items.find(p=>p.id===+e);s&&(this.quantity=s.quantity,this.quantityInBasket=s.quantity)}})},error:n=>console.log(n)})}incrementQuantity(){this.quantity++}decrementQuantity(){this.quantity--}updateBasket(e){this.quantity>this.quantityInBasket?this.basketService.AddItemToBasket(e,this.quantity-this.quantityInBasket):this.basketService.RemoveItemBasket(e.id,this.quantityInBasket-this.quantity),this.quantityInBasket=this.quantity}get buttonText(){return 0==this.quantityInBasket?"Add to basket":"Update to basket"}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(f),t.Y36(u.gz),t.Y36(C.pm),t.Y36(v.v))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-product-details"]],decls:1,vars:1,consts:[["class","row",4,"ngIf"],[1,"row"],[1,"col-6"],["alt","",1,"w-100",3,"src"],[1,"col-6","mt-5"],[1,"mb-3"],["class","fst-italic text-primary",4,"ngIf"],[1,"d-flex","align-items-center","justify-content-start","mb-3"],[1,"fa","fa-minus-circle","text-warning","me-2",2,"font-size","2em","cursor","pointer",3,"click"],[2,"font-size","1.5em"],[1,"fa","fa-plus-circle","text-warning","mx-2",2,"font-size","2em","cursor","pointer",3,"click"],["type","button",1,"btn","btn-primary","ms-2",3,"disabled","click"],[1,"fst-italic","text-primary"]],template:function(n,o){1&n&&t.YNc(0,T,21,10,"div",0),2&n&&t.Q6J("ngIf",o.product)},dependencies:[c.O5,c.H9]})}return i})();function S(i,a){if(1&i&&(t.TgZ(0,"header"),t._uU(1," Showing "),t.TgZ(2,"strong"),t._uU(3),t.qZA(),t._uU(4," of "),t.TgZ(5,"strong"),t._uU(6),t.qZA(),t._uU(7," Results\n"),t.qZA()),2&i){const e=t.oxw();t.xp6(3),t.AsE("",(e.pageIndex-1)*e.pageSize+1," - ",e.pageSize*e.pageIndex>e.totalItems?e.totalItems:e.pageSize*e.pageIndex," "),t.xp6(3),t.hij(" ",e.totalItems," ")}}let Z=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-paging-header"]],inputs:{totalItems:"totalItems",pageSize:"pageSize",pageIndex:"pageIndex"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(n,o){1&n&&t.YNc(0,S,8,3,"header",0),2&n&&t.Q6J("ngIf",o.totalItems&&o.pageIndex&&o.pageSize)},dependencies:[c.O5]})}return i})();var k=r(2521),l=r(433);function A(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"pagination",1),t.NdJ("pageChanged",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.onPagerChanged(o))}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("boundaryLinks",!0)("totalItems",e.totalItems)("itemsPerPage",e.pageSize)("maxSize",10)("ngModel",e.pageNumber)}}let q=(()=>{class i{constructor(){this.pagerChanged=new t.vpe}onPagerChanged(e){this.pagerChanged.emit(e.page)}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-pager"]],inputs:{totalItems:"totalItems",pageSize:"pageSize",pageNumber:"pageNumber"},outputs:{pagerChanged:"pagerChanged"},decls:1,vars:1,consts:[["class","d-flex mx-auto mt-3","previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",3,"boundaryLinks","totalItems","itemsPerPage","maxSize","ngModel","pageChanged",4,"ngIf"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",1,"d-flex","mx-auto","mt-3",3,"boundaryLinks","totalItems","itemsPerPage","maxSize","ngModel","pageChanged"]],template:function(n,o){1&n&&t.YNc(0,A,1,5,"pagination",0),2&n&&t.Q6J("ngIf",o.totalItems&&o.pageSize)},dependencies:[c.O5,k.Qt,l.JJ,l.On]})}return i})();function w(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",1)(1,"div",2),t._UZ(2,"img",3),t.TgZ(3,"div",4)(4,"button",5),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onAddToCart(o.product))}),t.qZA(),t.TgZ(5,"button",6),t._uU(6," View "),t.qZA()()(),t.TgZ(7,"div",7)(8,"a",8)(9,"h5",9),t._uU(10),t.qZA()(),t.TgZ(11,"h5"),t._uU(12),t.ALo(13,"currency"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.s9C("src",e.product.pictureUrl,t.LSH),t.xp6(3),t.MGl("routerLink","/shop/",e.product.id,""),t.xp6(5),t.Oqu(e.product.name),t.xp6(2),t.Oqu(t.lcZ(13,4,e.product.price))}}let O=(()=>{class i{constructor(e){this.basketService=e}onAddToCart(e){this.basketService.AddItemToBasket(e)}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(v.v))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-product-item"]],inputs:{product:"product"},decls:1,vars:1,consts:[["class","card shadow-sm h-100",4,"ngIf"],[1,"card","shadow-sm","h-100"],[1,"image","position-relative"],["alt","",1,"img-fluid","bg-info",3,"src"],[1,"d-flex","align-items-center","justify-content-center","hover-overlay"],["type","button",1,"btn","btn-primary","fa","fa-shopping-cart","me-2",3,"click"],["type","button",1,"btn","btn-primary",3,"routerLink"],[1,"card-body","d-flex","flex-column","align-content-center"],["href","",1,"text-decoration-none"],[1,"text-uppercase"]],template:function(n,o){1&n&&t.YNc(0,w,14,6,"div",0),2&n&&t.Q6J("ngIf",o.product)},dependencies:[c.O5,u.rH,c.H9],styles:[".btn[_ngcontent-%COMP%]{width:30%;height:40px}.image[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{opacity:1}.image[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover   button[_ngcontent-%COMP%]{transform:none;opacity:1}.hover-overlay[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:rgba(255,255,255,.5);opacity:0;transition:all .5s}.hover-overlay[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{z-index:1000;transition:all .5s}.hover-overlay[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-of-type{transform:translate(-20px)}.hover-overlay[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-of-type{transform:translate(20px)}"]})}return i})();const U=["search"];function M(i,a){if(1&i&&(t.TgZ(0,"option",23),t._uU(1),t.qZA()),2&i){const e=a.$implicit,n=t.oxw(2);t.s9C("value",e.value),t.Q6J("selected",n.productParams.sort===e.value),t.xp6(1),t.hij(" ",e.name," ")}}function J(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"li",24),t.NdJ("click",function(){const s=t.CHM(e).$implicit,p=t.oxw(2);return t.KtG(p.onBrandSelected(s.id))}),t._uU(1),t.qZA()}if(2&i){const e=a.$implicit,n=t.oxw(2);t.ekj("active",e.id===n.productParams.brandId),t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function z(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"li",25),t.NdJ("click",function(){const s=t.CHM(e).$implicit,p=t.oxw(2);return t.KtG(p.onTypeSelected(s.id))}),t._uU(1),t.qZA()}if(2&i){const e=a.$implicit,n=t.oxw(2);t.ekj("active",e.id===n.productParams.typeId),t.xp6(1),t.hij(" ",e.name," ")}}function N(i,a){if(1&i&&t._UZ(0,"app-paging-header",26),2&i){const e=t.oxw(2);t.Q6J("totalItems",e.totalItems)("pageIndex",e.productParams.pageIndex)("pageSize",e.productParams.pageSize)}}function B(i,a){1&i&&(t.TgZ(0,"span"),t._uU(1,"There are "),t.TgZ(2,"strong"),t._uU(3,"0"),t.qZA(),t._uU(4," result for this filter"),t.qZA())}function F(i,a){if(1&i&&(t.TgZ(0,"div",27),t._UZ(1,"app-product-item",28),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.Q6J("product",e)}}function Q(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"app-pager",29),t.NdJ("pagerChanged",function(o){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onPageChanged(o))}),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("totalItems",e.totalItems)("pageSize",e.productParams.pageSize)("pageNumber",e.productParams.pageIndex)}}function H(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"h5",5),t._uU(4,"Sort"),t.qZA(),t.TgZ(5,"select",6),t.NdJ("change",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.onSortSelected(o))}),t.YNc(6,M,2,3,"option",7),t.qZA()(),t.TgZ(7,"div",4)(8,"h5",5),t._uU(9,"Brands"),t.qZA(),t.TgZ(10,"ul",8),t.YNc(11,J,2,4,"li",9),t.qZA()(),t.TgZ(12,"div",4)(13,"h5",5),t._uU(14,"Types"),t.qZA(),t.TgZ(15,"ul",8),t.YNc(16,z,2,3,"li",10),t.qZA()()(),t.TgZ(17,"div",11)(18,"div",12),t.YNc(19,N,1,3,"app-paging-header",13),t.YNc(20,B,5,0,"span",14),t.TgZ(21,"div",15)(22,"input",16,17),t.NdJ("keyup.enter",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSearch())}),t.qZA(),t.TgZ(24,"button",18),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSearch())}),t._uU(25," Search "),t.qZA(),t.TgZ(26,"button",19),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onReset())}),t._uU(27," Reset "),t.qZA()()(),t.TgZ(28,"div",20),t.YNc(29,F,2,1,"div",21),t.qZA(),t.YNc(30,Q,1,3,"app-pager",22),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(5),t.Q6J("value",e.productParams.sort),t.xp6(1),t.Q6J("ngForOf",e.sortOptions),t.xp6(5),t.Q6J("ngForOf",e.brands),t.xp6(5),t.Q6J("ngForOf",e.types),t.xp6(3),t.Q6J("ngIf",e.totalItems>0),t.xp6(1),t.Q6J("ngIf",0==e.totalItems),t.xp6(9),t.Q6J("ngForOf",e.products),t.xp6(1),t.Q6J("ngIf",e.totalItems>0)}}const Y=[{path:"",component:(()=>{class i{constructor(e){this.shopService=e,this.products=[],this.brands=[],this.types=[],this.totalItems=0,this.sortOptions=[{name:"Alphabetical",value:"name"},{name:"Price:Low to high",value:"priceAsc"},{name:"Price:High to low",value:"priceDesc"}],this.productParams=this.shopService.getProductParams()}ngOnInit(){this.getProducts(),this.getBrands(),this.getTypes()}getProducts(){this.shopService.getProducts().subscribe({next:e=>{this.products=e.data,this.totalItems=e.count},error:e=>console.log(e)})}getBrands(){this.shopService.getBrands().subscribe({next:e=>{this.brands=[{id:0,name:"All"},...e]},error:e=>console.log(e)})}getTypes(){this.shopService.getTypes().subscribe({next:e=>{this.types=[{id:0,name:"All"},...e]},error:e=>console.log(e)})}onBrandSelected(e){var n=this.shopService.getProductParams();n.brandId=e,this.shopService.setProductParams(n),this.productParams=n,this.getProducts()}onTypeSelected(e){var n=this.shopService.getProductParams();n.typeId=e,n.pageIndex=1,this.shopService.setProductParams(n),this.productParams=n,this.getProducts()}onSortSelected(e){var n=this.shopService.getProductParams();n.sort=e.target.value,n.pageIndex=1,this.shopService.setProductParams(n),this.productParams=n,this.getProducts()}onPageChanged(e){var n=this.shopService.getProductParams();n.pageIndex!=e&&(n.pageIndex=e,this.shopService.setProductParams(n),this.productParams=n,this.getProducts())}onSearch(){var e=this.shopService.getProductParams();this.searchTerm?.nativeElement.value&&(e.search=this.searchTerm.nativeElement.value,e.pageIndex=1,this.shopService.setProductParams(e),this.productParams=e,this.getProducts())}onReset(){this.searchTerm?.nativeElement.value&&(this.searchTerm.nativeElement.value="");var e=new _;this.shopService.setProductParams(e),this.productParams=e,this.getProducts()}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(f))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-shop"]],viewQuery:function(n,o){if(1&n&&t.Gf(U,5),2&n){let s;t.iGM(s=t.CRH())&&(o.searchTerm=s.first)}},decls:2,vars:1,consts:[[1,"container"],["class","row",4,"ngIf"],[1,"row"],[1,"col-3"],[1,"mb-3"],[1,"text-warning","fs-3"],["name","","id","",1,"form-select",3,"value","change"],[3,"value","selected",4,"ngFor","ngForOf"],[1,"list-group"],["class","list-group-item",3,"active","value","click",4,"ngFor","ngForOf"],["class","list-group-item",3,"active","click",4,"ngFor","ngForOf"],[1,"col-9"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[3,"totalItems","pageIndex","pageSize",4,"ngIf"],[4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center"],["type","text","name","","id","","placeholder","Search",1,"form-control","me-2",3,"keyup.enter"],["search",""],[1,"btn","btn-outline-primary","me-2",3,"click"],[1,"btn","btn-outline-success","me-2",3,"click"],[1,"row","row-cols-3","g-3"],["class","col",4,"ngFor","ngForOf"],[3,"totalItems","pageSize","pageNumber","pagerChanged",4,"ngIf"],[3,"value","selected"],[1,"list-group-item",3,"value","click"],[1,"list-group-item",3,"click"],[3,"totalItems","pageIndex","pageSize"],[1,"col"],[3,"product"],[3,"totalItems","pageSize","pageNumber","pagerChanged"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t.YNc(1,H,31,8,"div",1),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngIf",o.brands.length>0&&o.types.length>0))},dependencies:[c.sg,c.O5,Z,q,l.YN,l.Kr,O],styles:[".list-group-item[_ngcontent-%COMP%]{border:0;padding:10px;font-size:1.1em;cursor:pointer}.list-group-item.active[_ngcontent-%COMP%]{border-radius:10px}.list-group-item[_ngcontent-%COMP%]:hover:not(.active){border-radius:10px;background:rgba(233,82,32,.8);color:#fff}"]})}return i})()},{path:":id",component:I,data:{breadcrumb:{alias:"productDetails"}}}];let j=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(Y),u.Bz]})}return i})(),G=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[c.ez,x.m,j]})}return i})()}}]);